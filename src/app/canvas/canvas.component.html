<ion-content class="custom-content">

<swiper-container id="data" pagination="true">

  <!-- Slide 1: Current track -->
  <swiper-slide>

    <div class='empty'></div>

    <div class='elementData card' [hidden]="!currentTrack || currentTrack.features[0].geometry.coordinates.length < 2">
      @if (currentTrack) {
        <table>
          <tr [ngClass]="status">
            <td colspan="2">{{ 'CANVAS.CURTITLE' | translate }}</td>
          </tr>
          <tr>
            <td>{{ 'CANVAS.DISTANCE' | translate }}</td>
            <td>{{ currentTrack.features[0].properties.totalDistance | number: '1.3' }} km</td>
          </tr>
          <tr>
            <td>{{ 'CANVAS.EGAIN' | translate }}</td>
            <td>{{ currentTrack.features[0].properties.totalElevationGain | number: '1.0-0' }} m</td>
          </tr>
            <td>{{ 'CANVAS.ELOSS' | translate }}</td>
            <td>{{ currentTrack.features[0].properties.totalElevationLoss | number: '1.0-0' }} m</td>
          <tr>
            <td>{{ 'CANVAS.TIME' | translate }}</td>
            <td>{{ currentTrack.features[0].properties.totalTime }}</td>
          </tr>
          <tr>
            <td>{{ 'CANVAS.MOTIONTIME' | translate }}</td>
            <td>{{ currentMotionTime }}</td>
          </tr>
          <tr>
            <td>{{ 'CANVAS.POINTS' | translate }}</td>
            <td>{{ currentTrack.features[0].properties.totalNumber }}</td>
          </tr>
          <tr>
            <td>{{ 'CANVAS.ALTITUDE' | translate }}</td>
            @if (currentTrack.features[0].properties.currentAltitude !== undefined) {
              <td>{{ currentTrack.features[0].properties.currentAltitude | number: '1.0-0' }} m</td>
            }
          </tr>
          <tr>
            <td>{{ 'CANVAS.SPEED' | translate }}</td>
            <td>
              @if (currentTrack.features[0].properties.currentAltitude !== undefined) {
                <div>{{ currentTrack.features[0].properties.currentSpeed | number: '1.1-1' }} km/h</div>
              }
            </td>
          </tr>
          <tr>
            <td>{{ 'CANVAS.AVGSPEED' | translate }}</td>
            <td>
              @if (currentAverageSpeed !== undefined) {
                <div>{{ currentAverageSpeed | number: '1.1-1' }} km/h</div>
              }
            </td>
          </tr>
          <tr>
            <td>{{ 'CANVAS.MOTIONAVGSPEED' | translate }}</td>
            <td>
              @if (currentMotionSpeed !== undefined) {
                <div>{{ currentMotionSpeed | number: '1.1-1' }} km/h</div>
              }
            </td>
          </tr>
          @if (status == 'green' && archivedTrack && currentPoint) {
            <tr>
              <td>{{ 'CANVAS.FROM_START' | translate }}</td>
              <td>
                <div>{{ archivedTrack.features[0].geometry.properties.data[currentPoint].distance | number: '1.3' }} km</div>
              </td>
            </tr>
            <tr>
              <td>{{ 'CANVAS.TO_END' | translate }}</td>
              <td>
                <div>{{ archivedTrack.features[0].properties.totalDistance - archivedTrack.features[0].geometry.properties.data[currentPoint].distance | number: '1.3' }} km</div>
              </td>
            </tr>
          }
        </table>
      }
    </div>

    <div class='elementCanvas' id='cc0' [hidden]="!currentTrack || currentTrack.features[0].geometry.coordinates.length < 2">
      <h1 class='title'>{{'CANVAS.CANVASALTITUDE' | translate}}</h1>
      <canvas class='canvas' id="currCanvas0" [attr.width]="canvasNum" [attr.height]="canvasNum"></canvas>
    </div>

    <div class='elementCanvas' id='cc1' [hidden]="!currentTrack || currentTrack.features[0].geometry.coordinates.length < 2">
      <h1 class='title'>{{'CANVAS.CANVASSPEED' | translate}} ({{currentUnit}})</h1>
      <canvas class='canvas' id="currCanvas1" [attr.width]="canvasNum" [attr.height]="canvasNum"></canvas>
    </div>

    <div class='empty'></div>
    <div class='empty'></div>

  </swiper-slide>

  <!-- Slide 2: Archived track -->
  <swiper-slide>

    <div class='empty'></div>

    <div id="exportArea">
      <div class='elementData card' [hidden]="!archivedTrack || layerVisibility != 'archived'">
        @if (archivedTrack) { 
          <table>
            <tr>
              <td colspan='2'>{{'CANVAS.ARCTITLE' | translate}}</td>
            </tr>
            <tr>
              <td colspan='2'>{{archivedTrack.features[0].properties.name}}</td>
            </tr>
            <tr>
              <td>{{'CANVAS.DISTANCE' | translate}}</td>
              @if (archivedTrack.features[0].properties.totalDistance > -1) {
                <td>
                  {{ archivedTrack.features[0].properties.totalDistance | number:'1.3' }} km
                </td>
              }
            </tr>
            <tr>
              <td>{{ 'CANVAS.EGAIN' | translate }}</td>
              @if (archivedTrack.features[0].properties.totalElevationGain > -1) {
                <td>
                  {{ archivedTrack.features[0].properties.totalElevationGain | number:'1.0-0' }} m
                </td>
              }
            </tr>
            <tr>
              <td>{{ 'CANVAS.ELOSS' | translate }}</td>
              @if (archivedTrack.features[0].properties.totalElevationLoss > -1) {
                <td>
                  {{ archivedTrack.features[0].properties.totalElevationLoss | number:'1.0-0' }} m
                </td>
              }
            </tr>
            <tr>
              <td>{{ 'CANVAS.TIME' | translate }}</td>
              @if (archivedTrack.features[0].properties.totalTime !== undefined) {
                <td>
                  {{ archivedTrack.features[0].properties.totalTime }}
                </td>
              }
            </tr>
            <tr>
              <td>{{'CANVAS.POINTS' | translate}}</td>
              <td>{{archivedTrack.features[0].properties.totalNumber}}</td>
            </tr>
          </table>
        } 
      </div>

      <div class='elementCanvas' id='ac0' [hidden]="!archivedTrack || layerVisibility != 'archived'">
        <h1 class='title'>{{'CANVAS.CANVASALTITUDE' | translate}}</h1>
        <canvas class='canvas' id="archCanvas0" [attr.width]="canvasNum" [attr.height]="canvasNum"></canvas>
      </div>
    </div>

    <div class='elementCanvas' id='ac1' [hidden]="!archivedTrack || layerVisibility != 'archived'">
      <h1 class='title'>{{'CANVAS.CANVASSPEED' | translate}} ({{archivedUnit}})</h1>
      <canvas class='canvas' id="archCanvas1" [attr.width]="canvasNum" [attr.height]="canvasNum"></canvas>
    </div>

    <div class='empty'></div>
    <div class='empty'></div>

  </swiper-slide>

  <!-- Slide 3: Archived track-2 -->

  <swiper-slide>
    <div class='empty'></div>
    <div class='elementData card' [hidden]="!archivedTrack || layerVisibility != 'archived'">
      @if (archivedTrack) {
        <table class="partials">
          <tr>
            <td colspan='3'>{{'CANVAS.ARCTITLE' | translate}}</td>
          </tr>
          <tr>
            <td colspan='3'>{{archivedTrack.features[0].properties.name}}</td>
          </tr>
          @for (ps of partialSpeeds; track i; let i = $index) {
            <tr>
              <td>{{ ps[0] }}</td>
              <td>{{ ps[1] }}</td>
              <td>{{ ps[2] | number:'1.2-2' }} km/h</td>
            </tr>
          }
        </table>
      }
    </div>
  </swiper-slide>

</swiper-container>

</ion-content>

<!-- space for android controls -->
<div class="bottom-safe-gray"></div>

  <!-- buttons to navigate -->
  <ion-fab
    slot="fixed"
    horizontal="center"
    vertical="bottom"
    class="bottom-safe no-export"
  >
    <ion-row>
      <ion-fab-button (click)="fs.gotoPage('tab1')">
        <ion-icon name="earth"></ion-icon>
      </ion-fab-button>
      <ion-fab-button id='list' (click)="fs.gotoPage('archive')">
        <ion-icon name="list"></ion-icon>
      </ion-fab-button>
      <ion-fab-button id='settings' (click)="fs.gotoPage('settings')">
        <ion-icon name="settings"></ion-icon>
      </ion-fab-button>
    </ion-row>
  </ion-fab>

