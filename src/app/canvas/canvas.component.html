
<ion-content class="custom-content">
  <swiper-container id="data" pagination="true">

    <swiper-slide>
      <div class="slide-wrapper">
        @if (present.currentTrack) {
          <div class='elementData card'>
        
            <table>
              <tr><td colspan="2" class="table-title">{{ 'CANVAS.CURTITLE' | translate }}</td></tr>
              <tr>
                <td>{{ 'CANVAS.DISTANCE' | translate }}</td>
                <td>{{ present.currentTrack.features[0].properties.totalDistance | number: '1.3' }} km</td>
              </tr>
              <tr>
                <td>{{ 'CANVAS.EGAIN' | translate }}</td>
                <td>{{ present.currentTrack.features[0].properties.totalElevationGain | number: '1.0-0' }} m</td>
              </tr>
              <tr>
                <td>{{ 'CANVAS.ELOSS' | translate }}</td>
                <td>{{ present.currentTrack.features[0].properties.totalElevationLoss | number: '1.0-0' }} m</td>
              </tr>
              <tr>
                <td>{{ 'CANVAS.TIME' | translate }}</td>
                <td>{{ formatMsec(present.currentTrack.features[0].properties.totalTime) }}</td>
              </tr>
              <tr>
                <td>{{ 'CANVAS.MOTIONTIME' | translate }}</td>
                <td>{{ formatMsec(present.currentTrack.features[0].properties.inMotion) }}</td>
              </tr>
              <tr>
                <td>{{ 'CANVAS.POINTS' | translate }}</td>
                <td>{{ present.currentTrack.features[0].properties.totalNumber }}</td>
              </tr>
              <tr>
                <td>{{ 'CANVAS.ALTITUDE' | translate }}</td>
                <td>{{ present.currentTrack.features[0].properties.currentAltitude | number: '1.0-0' }} m</td>
              </tr>
              <tr>
                <td>{{ 'CANVAS.SPEED' | translate }}</td>
                <td>{{ present.currentTrack.features[0].properties.currentSpeed | number: '1.1-1' }} km/h</td>
              </tr>
              <tr>
                <td>{{ 'CANVAS.AVGSPEED' | translate }}</td>
                <td>{{ fs.averageSpeed | number: '1.1-1' }} km/h</td>
              </tr>
              <tr>
                <td>{{ 'CANVAS.MOTIONAVGSPEED' | translate }}</td>
                <td>{{ fs.averageMotionSpeed | number: '1.1-1' }} km/h</td>
              </tr>
            </table>
          </div>

          <div class='canvas-container' id='cc0'>
            <h1 class='title'>{{'CANVAS.CANVASALTITUDE' | translate}}</h1>
            <canvas class='canvas' id="currCanvas0" [attr.width]="canvasSize" [attr.height]="canvasSize"></canvas>
          </div>

          <div class='canvas-container' id='cc1'>
            <h1 class='title'>{{'CANVAS.CANVASSPEED' | translate}} ({{currentUnit}})</h1>
            <canvas class='canvas' id="currCanvas1" [attr.width]="canvasSize" [attr.height]="canvasSize"></canvas>
          </div>
        } @else {
          <div class="empty-state">
            <div class="icon-container current">
              <ion-icon name="stats-chart-outline"></ion-icon>
            </div>
            <h3>No hay actividad actual</h3>
            <p>Inicia una grabación para empezar a visualizar los datos de altitud y velocidad en tiempo real.</p>
            <ion-button fill="clear" (click)="fs.gotoPage('tab1')">Ir al mapa</ion-button>
          </div>
        }
      </div>
    </swiper-slide>

    <swiper-slide>
      <div class="slide-wrapper">
        <div id="exportArea">
          @if (reference.archivedTrack) {
            <div class='elementData card'>
              <table>
                <tr><td colspan='2' class="table-title">{{'CANVAS.ARCTITLE' | translate}}</td></tr>
                <tr><td colspan='2' class="subtitle">{{reference.archivedTrack.features[0].properties.name}}</td></tr>
                <tr>
                  <td>{{'CANVAS.DISTANCE' | translate}}</td>
                  <td>{{ reference.archivedTrack.features[0].properties.totalDistance | number:'1.3' }} km</td>
                </tr>
                <tr>
                  <td>{{ 'CANVAS.EGAIN' | translate }}</td>
                  <td>{{ reference.archivedTrack.features[0].properties.totalElevationGain | number:'1.0-0' }} m</td>
                </tr>
                <tr>
                  <td>{{ 'CANVAS.ELOSS' | translate }}</td>
                  <td>{{ reference.archivedTrack.features[0].properties.totalElevationLoss | number:'1.0-0' }} m</td>
                </tr>
                <tr>
                  <td>{{ 'CANVAS.TIME' | translate }}</td>
                  <td>{{ formatMsec(reference.archivedTrack.features[0].properties.totalTime) }}</td>
                </tr>
                <tr>
                  <td>{{'CANVAS.POINTS' | translate}}</td>
                  <td>{{reference.archivedTrack.features[0].properties.totalNumber}}</td>
                </tr>
              </table>
            </div>
            <div class='canvas-container' id='ac0'>
              <h1 class='title'>{{'CANVAS.CANVASALTITUDE' | translate}}</h1>
              <canvas class='canvas' id="archCanvas0" [attr.width]="canvasSize" [attr.height]="canvasSize"></canvas>
            </div>
            <div class='canvas-container' id='ac1'>
              <h1 class='title'>{{'CANVAS.CANVASSPEED' | translate}} ({{archivedUnit}})</h1>
              <canvas class='canvas' id="archCanvas1" [attr.width]="canvasSize" [attr.height]="canvasSize"></canvas>
            </div>
          } @else {
          <div class="empty-state">
            <div class="icon-container archived">
              <ion-icon name="archive-outline"></ion-icon>
            </div>
            <h3>Archivo vacío</h3>
            <p>No has seleccionado ningún track del historial. Ve a la lista de archivos para cargar uno y comparar.</p>
            <ion-button fill="clear" (click)="fs.gotoPage('archive')">Ver historial</ion-button>
          </div>
        }
        </div>
      </div>
    </swiper-slide>

    <swiper-slide>
      <div class="slide-wrapper">
        @if (reference.archivedTrack) {
          <div class='elementData card'>
            <table class="partials">
              <tr><td colspan='3' class="table-title">{{'CANVAS.ARCTITLE' | translate}}</td></tr>
              <tr><td colspan='3' class="subtitle">{{reference.archivedTrack.features[0].properties.name}}</td></tr>
              @for (ps of partialSpeeds; track i; let i = $index) {
                <tr>
                  <td>{{ ps[0] }}</td>
                  <td>{{ ps[1] }}</td>
                  <td>{{ ps[2] | number:'1.2-2' }} km/h</td>
                </tr>
              }
            </table>
          </div>
        }  
      </div>
    </swiper-slide>

  </swiper-container>
</ion-content>

<div class="bottom-safe-gray"></div>

<ion-fab slot="fixed" horizontal="center" vertical="bottom" class="bottom-safe">
  <ion-row>
    <div class="record-button" (click)="fs.gotoPage('tab1')">
      <ion-icon name="earth-sharp"></ion-icon>
      <span>{{ 'MAP.MAP_BUTTON' | translate }}</span>
    </div>
    <div class="record-button" (click)="fs.gotoPage('archive')">
      <ion-icon name="list-sharp"></ion-icon>
      <span>{{ 'MAP.ARCHIVE_BUTTON' | translate }}</span>
    </div>
    <div class="record-button" (click)="fs.gotoPage('settings')">
      <ion-icon name="settings-sharp"></ion-icon>
      <span>{{ 'MAP.SETTINGS_BUTTON' | translate }}</span>
    </div>
  </ion-row>
</ion-fab>               